#!/usr/bin/env python3
"""
–°–∫—Ä–∏–ø—Ç –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —à–∞–Ω—Å–æ–≤ —Å–ª–æ—Ç-–º–∞—à–∏–Ω—ã
–£–º–µ–Ω—å—à–∞–µ—Ç –≤—Å–µ —à–∞–Ω—Å—ã –∫—Ä–æ–º–µ –≤–∏—à–µ–Ω –≤ 10 —Ä–∞–∑
"""
import sqlite3
import os
import sys

# –î–æ–±–∞–≤–ª—è–µ–º –ø—É—Ç—å –∫ –ø—Ä–æ–µ–∫—Ç—É
current_dir = os.path.dirname(os.path.abspath(__file__))
sys.path.insert(0, current_dir)
os.chdir(current_dir)

def update_slot_chances():
    """–û–±–Ω–æ–≤–ª—è–µ—Ç —à–∞–Ω—Å—ã –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö"""
    try:
        conn = sqlite3.connect('data/users.db')
        cursor = conn.cursor()
        
        print("üé∞ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —à–∞–Ω—Å–æ–≤ —Å–ª–æ—Ç-–º–∞—à–∏–Ω—ã...")
        
        # –ù–æ–≤—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (—à–∞–Ω—Å—ã —É–º–µ–Ω—å—à–µ–Ω—ã –≤ 10 —Ä–∞–∑ –∫—Ä–æ–º–µ –≤–∏—à–µ–Ω)
        new_configs = [
            ('üçíüçíüçí', 'money', 5, 0.8, 'üçí', '–í–∏—à–Ω–∏'),           # 0.8% - 5‚ÇΩ (–ù–ï –ò–ó–ú–ï–ù–ï–ù–û)
            ('üçäüçäüçä', 'money', 10, 0.06, 'üçä', '–ê–ø–µ–ª—å—Å–∏–Ω'),      # 0.06% - 10‚ÇΩ (–±—ã–ª–æ 0.6%)
            ('üçãüçãüçã', 'stars', 13, 0.03, 'üçã', '–õ–∏–º–æ–Ω'),         # 0.03% - 13‚≠ê (–±—ã–ª–æ 0.3%)
            ('üçáüçáüçá', 'stars', 21, 0.015, 'üçá', '–í–∏–Ω–æ–≥—Ä–∞–¥'),     # 0.015% - 21‚≠ê (–±—ã–ª–æ 0.15%)
            ('üíéüíéüíé', 'ton', 0.5, 0.008, 'üíé', '–ê–ª–º–∞–∑'),         # 0.008% - 0.5 TON (–±—ã–ª–æ 0.08%)
            ('‚≠êÔ∏è‚≠êÔ∏è‚≠êÔ∏è', 'stars', 50, 0.003, '‚≠êÔ∏è', '–ó–≤–µ–∑–¥—ã'),      # 0.003% - 50‚≠ê (–±—ã–ª–æ 0.03%)
            ('üîîüîîüîî', 'money', 100, 0.002, 'üîî', '–ö–æ–ª–æ–∫–æ–ª—å—á–∏–∫'), # 0.002% - 100‚ÇΩ (–±—ã–ª–æ 0.02%)
            ('üí∞üí∞üí∞', 'stars', 75, 0.0008, 'üí∞', '–ú–µ—à–æ–∫ –¥–µ–Ω–µ–≥'), # 0.0008% - 75‚≠ê (–±—ã–ª–æ 0.008%)
            ('üé∞üé∞üé∞', 'ton', 1.0, 0.0001, 'üé∞', '–î–∂–µ–∫–ø–æ—Ç'),      # 0.0001% - 1 TON (–±—ã–ª–æ 0.001%)
            ('7Ô∏è‚É£7Ô∏è‚É£7Ô∏è‚É£', 'stars', 100, 0.0001, '7Ô∏è‚É£', '–¢—Ä–∏ —Å–µ–º–µ—Ä–∫–∏'), # 0.0001% - 100‚≠ê (–±—ã–ª–æ 0.001%)
        ]
        
        # –û—á–∏—â–∞–µ–º —Å—Ç–∞—Ä—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
        cursor.execute("DELETE FROM slot_config")
        
        # –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
        for config in new_configs:
            cursor.execute('''INSERT INTO slot_config (combination, reward_type, reward_amount, chance_percent, emoji, name) 
                             VALUES (?, ?, ?, ?, ?, ?)''', config)
        
        conn.commit()
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
        cursor.execute("SELECT combination, chance_percent FROM slot_config ORDER BY chance_percent DESC")
        results = cursor.fetchall()
        
        print("\n‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —à–∞–Ω—Å—ã:")
        total_chance = 0
        for combination, chance in results:
            print(f"  {combination}: {chance}%")
            total_chance += chance
        
        print(f"\nüìä –û–±—â–∏–π –ø—Ä–æ—Ü–µ–Ω—Ç –≤—ã–∏–≥—Ä—ã—à–µ–π: {total_chance:.4f}%")
        print("üçí –í–∏—à–Ω–∏ –æ—Å—Ç–∞–ª–∏—Å—å –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π: 0.8%")
        print("üìâ –û—Å—Ç–∞–ª—å–Ω—ã–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ —É–º–µ–Ω—å—à–µ–Ω—ã –≤ 10 —Ä–∞–∑")
        
        conn.close()
        return True
        
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —à–∞–Ω—Å–æ–≤: {e}")
        return False

if __name__ == "__main__":
    success = update_slot_chances()
    if success:
        print("\nüéâ –®–∞–Ω—Å—ã —Å–ª–æ—Ç-–º–∞—à–∏–Ω—ã —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω—ã!")
    else:
        print("\nüí• –ù–µ —É–¥–∞–ª–æ—Å—å –æ–±–Ω–æ–≤–∏—Ç—å —à–∞–Ω—Å—ã!")
        sys.exit(1)
